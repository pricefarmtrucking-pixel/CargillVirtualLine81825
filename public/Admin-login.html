<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Admin Login — Cargill Soybean</title>
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:#222}
    body{background:#f5f7fa;margin:0}
    .wrap{max-width:420px;margin:10vh auto;background:#fff;border:1px solid #e7e7e7;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.06);padding:1.2rem}
    h2{margin:0 0 .6rem}
    label{display:block;margin:.5rem 0 .25rem;color:#555}
    input{width:100%;padding:.7rem .8rem;border:1px solid #ccc;border-radius:10px}
    .row{display:flex;gap:.5rem;margin-top:.75rem}
    .btn{border:1px solid #ddd;border-radius:10px;padding:.6rem 1rem;cursor:pointer;background:#1e90ff;color:#fff}
    .ghost{background:#f7f7f7;color:#222;border-color:#ddd}
    #msg{min-height:1.2em;margin-top:.5rem;font-size:.9rem}
  </style>
</head>
<body>
  <div class="wrap">
    <h2>Admin Login</h2>
    <p style="color:#666;margin-top:0">Enter your admin PIN to continue.</p>
    <label for="pin">PIN</label>
    <input id="pin" type="password" placeholder="••••" autocomplete="off"/>
    <div class="row">
      <button class="btn" onclick="login()">Login</button>
      <a class="btn ghost" href="landing.html">Back</a>
    </div>
    <div id="msg"></div>
  </div>

<script>
async function login(){
  const pin = document.getElementById('pin').value.trim();
  const msg = document.getElementById('msg');
  msg.textContent='';
  try{
    const r = await fetch('/admin/login', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      credentials:'include',
      body: JSON.stringify({ pin })
    });
    const j = await r.json().catch(()=>({}));
    if(!r.ok || j.error){ msg.textContent = j.error || 'Login failed'; msg.style.color='#b00020'; return; }
    msg.textContent = 'Success! Redirecting…'; msg.style.color='#0a7a28';
    location.href = 'facility-schedule.html';
  }catch(e){
    msg.textContent = e?.message || 'Network error'; msg.style.color='#b00020';
  }
}
</script>
</body>
</html>
